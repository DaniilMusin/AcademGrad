# Анализ репозитория AcademGrad

## Проверка репозитория `DaniilMusin/AcademGrad`

> *GitHub не разрешает гостям просматривать приватные (или полу‑приватные) файлы без авторизации, поэтому из‑за ограничений браузера в чат‑режиме я вижу только верхний уровень каталогов.*
> *Тем не менее, по открытой структуре понятно, что проект пока включает только front‑end Next.js и голый каталог `supabase`, но отсутствуют большинство инфраструктурных частей, описанных в MVP/MLP‑документах.*

Ниже — чек‑лист, **что стоит добавить**, чтобы код соответствовал техническому заданию 2.0 и запускался «под ключ».

## Компоненты к добавлению

| №  | Компонент                                         | Статус                                  | Что сделать                                                                                                                                                                                                                     |
| -- | ------------------------------------------------- | --------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1  | **Supabase SQL‑миграции** (`supabase/migrations`) | **отсутствует**                         | ▸ Создать файлы `*_init.sql`, `*_views.sql` со схемой `tasks`, `attempts`, `task_chunks`, `events`, `lesson_reports`, `badges`, `user_badges`, RLS‑policy.<br>▸ Добавить функцию `match_task_chunks` и мат. view `weak_topics`. |
| 2  | **Edge Functions**                                | **нет папки `edge-functions`**          | ▸ Создать подпапки:<br>  `chat-task/` (стрим GPT‑4o + RAG)<br>  `log-attempt/`<br>  `badge-cron/`<br>  `weekly-report/`<br>  `tg-bot/`<br>  `payment/`.<br>▸ Каждый — файл `index.ts` (Deno).                                   |
| 3  | **Векторные эмбеддинги**                          | **нет скриптов**                        | ▸ Добавить `scripts/import_tasks.py` (чтение Markdown → tasks) и `embed_chunks.py` (OpenAI embedding → task\_chunks).                                                                                                           |
| 4  | **Github Actions**                                | `.github/workflows` **есть, но пустой** | ▸ Добавить: `ci.yml` (lint+test+db push), `embed.yml` (ночной эмбед), `cron.yml` (badge‑cron + spaced‑rep).                                                                                                                     |
| 5  | **Unit/E2E‑тесты**                                | **нет**                                 | ▸ Настроить Jest/Vitest для утилит и Playwright для smoke‑flow (login → solve task → chat).                                                                                                                                     |
| 6  | **PWA/Offline**                                   | **нет manifest и SW**                   | ▸ Установить `next-pwa`, создать `next.config.mjs`, `public/manifest.json`, иконки 192/512.                                                                                                                                     |
| 7  | **Payment интеграция**                            | **нет**                                 | ▸ Папка `api/checkout` (Stripe session) + webhook Edge‑Function.<br>▸ В .env указать `STRIPE_SECRET_KEY`.                                                                                                                       |
| 8  | **Telegram бот**                                  | **нет**                                 | ▸ Создать `edge-functions/tg-bot/index.ts` с webhook, метод `/tasks_today`.                                                                                                                                                     |
| 9  | **Weekly PDF отчёт**                              | **нет**                                 | ▸ Скрипт `generate_pdf.py` (WeasyPrint) + Edge‑Function `weekly-report`.                                                                                                                                                        |
| 10 | **Spaced‑repetition**                             | **нет**                                 | ▸ Python cron‑скрипт `spaced_repetition.py` + таблица `recommendations`.                                                                                                                                                        |
| 11 | **Onboarding Wizard**                             | **страниц `/onboarding` нет**           | ▸ Создать 4 RSC‑страницы, сохранять JSON `users.preferences`.                                                                                                                                                                   |
| 12 | **Бейджи/XP**                                     | **нет UI и таблиц**                     | ▸ SQL‑seed `badges`, cron‑функция `award_streak_badges`, компонент карусели в Dashboard.                                                                                                                                        |
| 13 | **Env/Secrets example**                           | **отсутствует**                         | ▸ Добавить `.env.example` с ключами Supabase, OpenAI, Stripe, BOT.                                                                                                                                                              |
| 14 | **Документация**                                  | README **минимальный**                  | ▸ Полный Quick‑start, локальный run, миграции, deploy (Vercel).                                                                                                                                                                 |
| 15 | **Monitoring / Sentry**                           | **нет**                                 | ▸ Подключить Sentry JS в `_app.tsx`; prom‑metric в Edge‑Functions.                                                                                                                                                              |
| 16 | **License**                                       | **нет LICENSE**                         | ▸ MIT или AGPL по выбору.                                                                                                                                                                                                       |

## Приоритет добавления

### 1. Критический уровень (должно работать базово)
- **Миграции + Edge чат/логик** — чтобы база и чат‑бот заработали.
- **Скрипты импорта/эмбеддинга** — наполнение контентом.

### 2. Высокий приоритет (качество разработки)
- **GitHub CI** — контроль качества при каждом push.
- **Unit/E2E тесты** — предотвращение регрессий.

### 3. Средний приоритет (UX улучшения)
- **Wizard + Dashboard фичи** — UX улучшения.
- **Env/Secrets example** — упрощение разворачивания.

### 4. Низкий приоритет (монетизация и продвинутые фичи)
- **Payments / Notifications / PWA** — монетизация и удержание.
- **Monitoring / Sentry** — production readiness.

## Следующие шаги

### Этап 1: Инфраструктурная основа
1. **Создайте ветку `backend-init`**, добавьте миграции + RLS, закоммитьте.
2. Разверните **`supabase db reset` локально**, убедитесь, что схема создаётся.
3. Добавьте **`edge-functions/chat-task`** и протестируйте SSE‑чат (`curl`).
4. Залейте **scripts**, импортируйте 1‑2 Markdown‑задачи, убедитесь, что RAG выдаёт ответ.

### Этап 2: CI/CD и качество
5. Настройте **GitHub Actions** для автоматического тестирования.
6. Добавьте **базовые unit-тесты** для критических функций.
7. Создайте **`.env.example`** с примерами всех необходимых переменных.

### Этап 3: UX и продуктовые фичи
8. Реализуйте **Onboarding Wizard** (Epic E‑1).
9. Добавьте **систему бейджей и XP**.
10. Интегрируйте **PWA возможности**.

### Этап 4: Монетизация и production
11. Подключите **Stripe payments**.
12. Реализуйте **Telegram бота**.
13. Добавьте **мониторинг и error tracking**.

## Текущее состояние проекта

### ✅ Уже реализовано
- Базовая структура Next.js приложения
- Основная папочная структура Supabase
- Скелет некоторых Python скриптов
- GitHub workflows папка (пустая)

### ❌ Отсутствует
- SQL миграции и схема базы данных
- Edge Functions для серверной логики
- Рабочие скрипты для импорта и эмбеддинга
- CI/CD пайплайны
- Тестирование
- Документация для разработчиков
- Production-ready конфигурация

## Заключение

Проект находится на очень ранней стадии разработки. Фактически реализован только фронтенд каркас, но отсутствует вся серверная инфраструктура. Для достижения MVP состояния необходимо реализовать как минимум первые 4 компонента из списка выше.

Если понадобится подробный код любой из этих частей — можно уточнить точечно.